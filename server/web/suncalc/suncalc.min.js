!function(){"use strict";var b=Math.PI,f=Math.sin,l=Math.cos,h=Math.tan,a=Math.asin,M=Math.atan2,d=Math.acos,H=b/180,e=864e5,n=2440588,r=2451545;function T(t){return new Date((t+.5-n)*e)}function E(t){return t.valueOf()/e-.5+n-r}var u=23.4397*H;function o(t,n){return M(f(t)*l(u)-h(n)*f(u),l(t))}function I(t,n){return a(f(n)*l(u)+l(n)*f(u)*f(t))}function v(t,n,e){return M(f(t),l(t)*f(n)-h(e)*l(n))}function g(t,n,e){return a(f(n)*f(e)+l(n)*l(e)*l(t))}function w(t,n){return H*(280.16+360.9856235*t)-n}function k(t){return H*(357.5291+.98560028*t)}function q(t){return t+H*(1.9148*f(t)+.02*f(2*t)+3e-4*f(3*t))+102.9372*H+b}function c(t){var n=q(k(t));return{dec:I(n,0),ra:o(n,0)}}var y={getPosition:function(t,n,e){var a=H*-e,r=H*n,u=E(t),o=c(u),i=w(u,a)-o.ra;return{azimuth:v(i,r,o.dec),altitude:g(i,r,o.dec)}}},x=y.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];y.addTime=function(t,n,e){x.push([t,n,e])};var z=9e-4;function C(t,n,e){return z+(t+n)/(2*b)+e}function O(t,n,e){return r+t+.0053*f(n)-.0069*f(2*e)}function S(t,n,e,a,r,u,o){var i,c;return O(C((i=e,c=a,d((f(t)-f(i)*f(c))/(l(i)*l(c)))),n,r),u,o)}function m(t){var n=H*(134.963+13.064993*t),e=H*(93.272+13.22935*t),a=H*(218.316+13.176396*t)+6.289*H*f(n),r=5.128*H*f(e),u=385001-20905*l(n);return{ra:o(a,r),dec:I(a,r),dist:u}}function U(t,n){return new Date(t.valueOf()+n*e/24)}y.getTimes=function(t,n,e,a){for(var r,u,o,i,c,d,s=H*-e,f=H*n,l=(d=a=a||0,-2.076*Math.sqrt(d)/60),h=E(t),M=(i=h,c=s,Math.round(i-z-c/(2*b))),v=C(0,s,M),g=k(v),w=q(g),m=I(w,0),p=O(v,g,w),D={solarNoon:T(p),nadir:T(p-.5)},P=0,y=x.length;P<y;P+=1)o=p-((u=S(((r=x[P])[0]+l)*H,s,f,m,M,g,w))-p),D[r[1]]=T(o),D[r[2]]=T(u);return D},y.getMoonPosition=function(t,n,e){var a,r=H*-e,u=H*n,o=E(t),i=m(o),c=w(o,r)-i.ra,d=g(c,u,i.dec),s=M(f(c),h(u)*l(i.dec)-f(i.dec)*l(c));return d+=((a=d)<0&&(a=0),2967e-7/Math.tan(a+.00312536/(a+.08901179))),{azimuth:v(c,u,i.dec),altitude:d,distance:i.dist,parallacticAngle:s}},y.getMoonIllumination=function(t){var n=E(t||new Date),e=c(n),a=m(n),r=d(f(e.dec)*f(a.dec)+l(e.dec)*l(a.dec)*l(e.ra-a.ra)),u=M(149598e3*f(r),a.dist-149598e3*l(r)),o=M(l(e.dec)*f(e.ra-a.ra),f(e.dec)*l(a.dec)-l(e.dec)*f(a.dec)*l(e.ra-a.ra));return{fraction:(1+l(u))/2,phase:.5+.5*u*(o<0?-1:1)/Math.PI,angle:o}},y.getMoonTimes=function(t,n,e,a){var r=new Date(t);a?r.setUTCHours(0,0,0,0):r.setHours(0,0,0,0);for(var u,o,i,c,d,s,f,l,h,M,v,g,w,m=.133*H,p=y.getMoonPosition(r,n,e).altitude-m,D=1;D<=24&&(u=y.getMoonPosition(U(r,D),n,e).altitude-m,l=((d=(p+(o=y.getMoonPosition(U(r,D+1),n,e).altitude-m))/2-u)*(f=-(s=(o-p)/2)/(2*d))+s)*f+u,(M=0)<=(h=s*s-4*d*u)&&(v=f-(w=Math.sqrt(h)/(2*Math.abs(d))),g=f+w,Math.abs(v)<=1&&M++,Math.abs(g)<=1&&M++,v<-1&&(v=g)),1===M?p<0?i=D+v:c=D+v:2===M&&(i=D+(l<0?g:v),c=D+(l<0?v:g)),!i||!c);D+=2)p=o;var P={};return i&&(P.rise=U(r,i)),c&&(P.set=U(r,c)),i||c||(P[0<l?"alwaysUp":"alwaysDown"]=!0),P},"object"==typeof exports&&"undefined"!=typeof module?module.exports=y:"function"==typeof define&&define.amd?define(y):window.SunCalc=y}();